<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seurat integration • Treefit for R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Seurat integration">
<meta property="og:description" content="">
<meta property="og:image" content="https://hayamizu-lab.github.io/treefit-r/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Treefit for R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/treefit.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/seurat-integration.html">Seurat integration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hayamizu-lab/treefit-r">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Seurat integration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hayamizu-lab/treefit-r/blob/master/vignettes/seurat-integration.Rmd"><code>vignettes/seurat-integration.Rmd</code></a></small>
      <div class="hidden name"><code>seurat-integration.Rmd</code></div>

    </div>

    
    
<p>This document introduces how to use Treefit with Seurat. You need to perform pre-processing such as removing contaminations against the input data to improve precision. You can use <a href="https://satijalab.org/seurat/">Seurat</a> for pre-processing.</p>
<p>In this document, you analyze the dataset of <a href="https://www.nature.com/articles/nbt.2859"><strong>Trapnell <i>el al.</i>, 2014, Nature Biotechnology</strong></a> with Treefit. Their paper describes the details of the dataset. The dataset was collected to research the process of the differentiation and maturation of human myoblasts. The dataset fits to bifurcation model, not linear model. Because there are cells that differentiate to not muscle cells.</p>
<p>You need to load the dataset. <a href="https://dynverse.org/">dynverse</a> provides the dataset that can be loaded by <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>. You can download the dataset from <a href="https://zenodo.org/record/1443566" class="uri">https://zenodo.org/record/1443566</a> .</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">trapnell.path &lt;-<span class="st"> "myoblast-differentiation_trapnell.rds"</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(trapnell.path)) {</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="st">"https://zenodo.org/record/1443566/files/real/gold/myoblast-differentiation_trapnell.rds?download=1"</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">                trapnell.path,</a>
<a class="sourceLine" id="cb1-5" title="5">                <span class="dt">mode=</span><span class="st">"wb"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">}</a>
<a class="sourceLine" id="cb1-7" title="7">trapnell.dynverse &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(trapnell.path)</a></code></pre></div>
<p>You can pre-process the dataset by Seurat.</p>
<p>You need to create a Seurat object to pre-process. You need to transpose the loaded dataset provided by dynverse to create Seurat object. Because dynverse uses rows are cells and columns are genes format but Seurat object uses rows are genes and columns are cells format.</p>
<p>You can pre-process by specifying some parameters to create Seurat object. In this document, you perform the following pre-processing:</p>
<ul>
<li>Removing genes that aren’t expressed in at least 3 cells</li>
<li>Removing cells that doesn’t have at least 200 expressed genes</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">trapnell &lt;-<span class="st"> </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/CreateSeuratObject.html">CreateSeuratObject</a></span>(<span class="dt">counts=</span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(trapnell.dynverse<span class="op">$</span>count),</a>
<a class="sourceLine" id="cb2-2" title="2">                                       <span class="dt">min.cells=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">                                       <span class="dt">min.features=</span><span class="dv">200</span>)</a></code></pre></div>
<pre><code>## Warning: Feature names cannot have underscores ('_'), replacing with dashes
## ('-')</code></pre>
<p>You can estimate quantitative tree-likeness of the dataset pro-processed by Seurta.</p>
<p>You can use <code><a href="../reference/estimate.html">treefit::estimate()</a></code> to estimate tree-likeness:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">estimated &lt;-<span class="st"> </span>treefit<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/treefit/man/estimate.html">estimate</a></span>(trapnell)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(estimated)</a></code></pre></div>
<pre><code>##   k                  method      mean standard_deviation
## 1 1  grassmann_distance_max 0.7908482         0.19863229
## 2 1 grassmann_distance_mean 0.6634866         0.28044669
## 3 2  grassmann_distance_max 0.4024010         0.07624083
## 4 2 grassmann_distance_mean 0.3316872         0.11519797
## 5 3  grassmann_distance_max 0.3222359         0.05763355
## 6 3 grassmann_distance_mean 0.3401627         0.08899357</code></pre>
<p>The estimated result is a <code>data.frame</code>. The following points should be focused:</p>
<ul>
<li>
<code>mean</code> and <code>standard_deviation</code> column values when <code>method</code> column value is <code>"grassman_distance_max"</code> (Grassmann distance max case)</li>
<li>
<code>k</code>, <code>mean</code> and <code>standard_deviation</code> column values when <code>method</code> column value is <code>"grassman_distance_mean"</code> (Grassmann distance mean case)</li>
</ul>
<p>In the Grassmann distance max case, the smaller values in the <code>mean</code> and <code>standadard_deviation</code> columns, the more tree-like the input data is.</p>
<p>In the Grassmann distance mean case, the <code>k</code> column value will relate to the number of the major cell lines when the <code>mean</code> column value is the smallest. The number of the major cell lines will be <code>k + 1</code> of the case. For example, the <code>k</code> column value is <code>2</code> when the <code>mean</code> column value is the smallest, <code>3 = k(2) + 1</code> will be the number of the major cell lines.</p>
<p>You can confirm the above points by visualizing the estimated result. You can visualize by <code><a href="../reference/plot_estimated.html">treefit::plot_estimated()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">treefit<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/treefit/man/plot_estimated.html">plot_estimated</a></span>(estimated)</a></code></pre></div>
<p><img src="seurat-integration_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>X-axis shows the <code>k</code> column values. Y-axis shows the <code>mean</code> column values. The <code>standard_deviation</code> column values are showed as error bar. The shorter error bar shows smaller the <code>standard_deviation</code> column value.</p>
<p>In the Grassmann distance max case, you need to confirm the values of the the <code>mean</code> and <code>standard_deviation</code> columns. The smallest <code>mean</code> column value is almost 0.1. The <code>standard_deviation</code> column value is almost 0 after the <code>k</code> column value is 5. It means that the dataset will be almost tree-like. It’s true because the dataset is known as a tree-like dataset.</p>
<p>In the Grassmann distance mean case, you need to confirm the <code>k</code> value when the <code>mean</code> column value is the smallest. It’s <code>2</code>. It means that the number of the major cell lines will be <code>3 = 2 + 1</code>. It’s true because the dataset fits to bifurcation model.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Momoko Hayamizu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
